<!DOCTYPE html>
<html>

<body>
  <h1>Test site</h1>

  <button onclick="getPixel()" disabled>Fetch next job</button>

  <div id="logs"></div>

  <script>
    /*
    const socket = new WebSocket(location.href.replace("https", "wss").replace("http", "ws") + 'api/ws');
    socket.onopen = () => {
      console.log("Connected to server; Waiting for id...");
    };*/

    var id = null;

    function log(msg) {
      var p = document.createElement("p");
      p.innerHTML = msg;
      document.getElementById("logs").appendChild(p);
    }

    const COLOR_MAPPINGS = {
        '#6D001A': 0,
        '#BE0039': 1,
        '#FF4500': 2,
        '#FFA800': 3,
        '#FFD635': 4,
        '#FFF8B8': 5,
        '#00A368': 6,
        '#00CC78': 7,
        '#7EED56': 8,
        '#00756F': 9,
        '#009EAA': 10,
        '#00CCC0': 11,
        '#2450A4': 12,
        '#3690EA': 13,
        '#51E9F4': 14,
        '#493AC1': 15,
        '#6A5CFF': 16,
        '#94B3FF': 17,
        '#811E9F': 18,
        '#B44AC0': 19,
        '#E4ABFF': 20,
        '#DE107F': 21,
        '#FF3881': 22,
        '#FF99AA': 23,
        '#6D482F': 24,
        '#9C6926': 25,
        '#FFB470': 26,
        '#000000': 27,
        '#515252': 28,
        '#898D90': 29,
        '#D4D7D9': 30,
        '#FFFFFF': 31
      };

    /*socket.onmessage = (msg) => {
      var data;
      try {
        data = JSON.parse(msg.data);
      } catch (e) {
        console.log("Invalid JSON: ", e, msg);
        return;
      }

      switch (data.type.toLowerCase()) {
        case "register":
          id = data.id;
          console.log("Registered with id: ", id);
        break;
        case "job":
          if (!id) return;
          if (!data.data) {
            log("No jobs available... idling");
            return;
          }
          console.log("New job received: ", data.data);
          log("New job received: " + JSON.stringify(data.data));
          break;
        default:
          console.log("Data received: ", data);
          var p = document.createElement("p");
          p.innerHTML = "Data: " + JSON.stringify(data.data);
          document.getElementById("logs").appendChild(p);
          break;
      }
    };

    function getPixel() {
      if (!id) return alert("Still registering on server!");
      socket.send(JSON.stringify({ type: "getJob" }));
    }*/
  </script>
</body>

</html>
